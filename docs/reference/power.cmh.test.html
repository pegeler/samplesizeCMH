<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power and sample size calculation for the Cochran-Mantel-Haenszel test — power.cmh.test • samplesizeCMH</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power and sample size calculation for the Cochran-Mantel-Haenszel test — power.cmh.test"><meta property="og:description" content="Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in J stratified 2 x 2
tables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samplesizeCMH</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/samplesizeCMH-introduction.html">Introduction to the Cochran-Mantel-Haenszel Test</a>
    </li>
    <li>
      <a href="../articles/samplesizeCMH-power.html">Power Calculation for the Cochran-Mantel-Haenszel Test</a>
    </li>
    <li>
      <a href="../articles/samplesizeCMH-samplesize.html">Sample Size Calculation for the Cochran-Mantel-Haenszel Test</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pegeler/samplesizeCMH/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power and sample size calculation for the Cochran-Mantel-Haenszel test</h1>
    <small class="dont-index">Source: <a href="https://github.com/pegeler/samplesizeCMH/blob/HEAD/R/power.cmh.test.r" class="external-link"><code>R/power.cmh.test.r</code></a></small>
    <div class="hidden name"><code>power.cmh.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in <em>J</em> stratified 2 x 2
tables.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power.cmh.test</span><span class="op">(</span>p1 <span class="op">=</span> <span class="cn">NULL</span>, p2 <span class="op">=</span> <span class="cn">NULL</span>, theta <span class="op">=</span> <span class="cn">NULL</span>, N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.8</span>, alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>,</span>
<span>  <span class="st">"greater"</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">0.5</span>, t <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">J</span>, correct <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>p1</dt>
<dd><p>Vector of proportions of the <em>J</em> case groups.</p></dd>


<dt>p2</dt>
<dd><p>Vector of proportions of the <em>J</em> control groups.</p></dd>


<dt>theta</dt>
<dd><p>Vector of odds ratios relating to the <em>J</em> 2 x 2 tables.</p></dd>


<dt>N</dt>
<dd><p>Total number of subjects.</p></dd>


<dt>sig.level</dt>
<dd><p>Significance level (Type I error probability).</p></dd>


<dt>power</dt>
<dd><p>Power of test (1 minus Type II error probability).</p></dd>


<dt>alternative</dt>
<dd><p>Two- or one-sided test. If one-sided, the direction of the
association must be defined (less than 1 or greater than 1). Can be
abbreviated.</p></dd>


<dt>s</dt>
<dd><p>Proportion (weight) of case versus control in <em>J</em> stratum.</p></dd>


<dt>t</dt>
<dd><p>Proportion (weight) of total number of cases of <em>J</em> stratum.</p></dd>


<dt>correct</dt>
<dd><p>Logical indicating whether to apply continuity correction.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"power.cmh"</code>: a list of the original arguments and
the calculated sample size or power. Also included are vectors of n's per
each group, an indicator or whether continuity correction was used, the
original function call, and <code>N.effective</code>.</p>


<p>The vectors of n's per each group, <code>n1</code> and <code>n2</code>, are the
fractional n's required to achieve a final total N specified by the
calculation while satisfying the constraints of <code>s</code> and <code>t</code>.
However, the effective N, given the requirement of cell counts populated by
whole numbers is provided by <code>N.effective</code>. By default, the print method
is set to <code>n.frac = FALSE</code>, which will round each cell n up to the
nearest whole number.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This sample size calculation is based on the derivations described in the
Woolson <em>et al.</em> (1986). It is designed for case-control studies where
one margin is fixed. The method is "based on the Cochran-Mantel-Haenszel
statistic expressed as a weighted difference in binomial proportions."</p>
<p>Continuity corrected sample size is described in Nam's 1992 paper. This uses
the weighted binomial sample size calculation described in Woolson <em>et
al.</em> (1986) but is enhanced for use with the continuity corrected Cochran's
test.</p>
<p>Power calculations are based on the writings of Wittes and Wallenstein
(1987). They are functionally equivalent to the derivations of the sample
size calculation described by Woolson and others and Nam, but have slightly
added precision.</p>
<p>Terminology and symbolic conventions are borrowed from Woolson <em>et al.</em>
(1986). The <code>p1</code> group is dubbed the <em>Case</em> group and <code>p2</code>
group is called the <em>Control</em> group.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    


<p>To calculate <strong>power</strong>, the <code>power</code> parameter must be set to
<code>NULL</code>. To calculate <strong>sample size</strong>, the <code>N</code> parameter must
be set to <code>NULL</code>.</p>
<p>The <code>J</code> number of groups will be inferred by the maximum length of
<code>p1</code>, <code>p2</code>, or <code>theta</code>.</p>
<p>Effect size must be specified using one of the following combinations of
arguments.</p><ul><li><p>Both case and control proportion vectors, ex.,</p><ul><li><p><code>p1</code> and <code>p2</code> with <code>theta = NULL</code>.</p></li>
</ul></li>
<li><p>One proportion vector and an effect size, ex.,</p><ul><li><p><code>p1</code> and <code>theta</code> with <code>p2 = NULL</code>, <strong>or</strong></p></li>
<li><p><code>p2</code> and <code>theta</code> with <code>p1 = NULL</code>.</p></li>
</ul></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Gail, M. (1973). "The determination of sample sizes for trials involving
several 2 x 2 tables."
<em>Journal of Chronic Disease</em> <strong>26</strong>: 669-673.</p>
<p>Munoz, A. and B. Rosner. (1984). "Power and sample size for a collection of 2
x 2 tables." <em>Biometrics</em> <strong>40</strong>: 995-1004.</p>
<p>Nam, J. (1992). "Sample size determination for case-control studies and the
comparison of stratified and unstratified analyses."
<em>Biometrics</em> <strong>48</strong>: 389-395.</p>
<p>Wittes, J. and S. Wallenstein. (1987). "The power of the Mantel-Haenszel
test." <em>Journal of the American Statistical Association</em> <strong>82</strong>:
1104-1109.</p>
<p>Woolson, R. F., Bean, J. A., and P. B. Rojas. (1986).
"Sample size for case-control studies using Cochran's statistic."
<em>Biometrics</em> <strong>42</strong>: 927-932.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/stats/power.prop.test.html" class="external-link">power.prop.test</a>,
<a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a>,
<a href="https://andrisignorell.github.io/DescTools/reference/BreslowDayTest.html" class="external-link">BreslowDayTest</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Paul W. Egeler, M.S.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># From "Sample size determination for case-control studies and the comparison</span></span></span>
<span class="r-in"><span><span class="co"># of stratified and unstratified analyses", (Nam 1992). See references.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Uncorrected sample size estimate first introduced</span></span></span>
<span class="r-in"><span><span class="co"># by Woolson and others in 1986</span></span></span>
<span class="r-in"><span><span class="va">sample_size_uncorrected</span> <span class="op">&lt;-</span> <span class="fu">power.cmh.test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.70</span>,<span class="fl">0.65</span>,<span class="fl">0.60</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  power <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>  t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.40</span>,<span class="fl">0.35</span>,<span class="fl">0.15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alternative <span class="op">=</span> <span class="st">"greater"</span>,</span></span>
<span class="r-in"><span>  correct <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_size_uncorrected</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power and sample size calculation for the Cochran Mantel Haenszel test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  N = 171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Effective N = 174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Power = 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Alternative = greater</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power.cmh.test(p2 = c(0.75, 0.7, 0.65, 0.6), theta = 3, power = 0.9, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = "greater", t = c(0.1, 0.4, 0.35, 0.15), correct = FALSE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We see that the N is 171, the same as calculated by Nam</span></span></span>
<span class="r-in"><span><span class="va">sample_size_uncorrected</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 170.7412</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Continuity corrected sample size estimate added by Nam</span></span></span>
<span class="r-in"><span><span class="va">sample_size_corrected</span> <span class="op">&lt;-</span> <span class="fu">power.cmh.test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.70</span>,<span class="fl">0.65</span>,<span class="fl">0.60</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  power <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>  t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.40</span>,<span class="fl">0.35</span>,<span class="fl">0.15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alternative <span class="op">=</span> <span class="st">"greater"</span>,</span></span>
<span class="r-in"><span>  correct <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_size_corrected</span>, n.frac <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power and sample size calculation for the Cochran Mantel Haenszel test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  N = 191.538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Effective N = 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Power = 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Alternative = greater</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects per each group:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ______________________________________________</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group   |       1        2        3        4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ==============================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Case    |    9.58    38.31    33.52    14.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Control |    9.58    38.31    33.52    14.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power.cmh.test(p2 = c(0.75, 0.7, 0.65, 0.6), theta = 3, power = 0.9, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = "greater", t = c(0.1, 0.4, 0.35, 0.15), correct = TRUE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We see that the N is indeed equal to that which is reported in the paper</span></span></span>
<span class="r-in"><span><span class="va">sample_size_corrected</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 191.538</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul Egeler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


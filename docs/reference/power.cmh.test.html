<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power and sample size calculation for the Cochran-Mantel-Haenszel test — power.cmh.test • samplesizeCMH</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power and sample size calculation for the Cochran-Mantel-Haenszel test — power.cmh.test"><meta name="description" content="Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in J stratified 2 x 2
tables."><meta property="og:description" content="Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in J stratified 2 x 2
tables."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">samplesizeCMH</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/samplesizeCMH-introduction.html">Introduction to the Cochran-Mantel-Haenszel Test</a></li>
    <li><a class="dropdown-item" href="../articles/samplesizeCMH-power.html">Power Calculation for the Cochran-Mantel-Haenszel Test</a></li>
    <li><a class="dropdown-item" href="../articles/samplesizeCMH-samplesize.html">Sample Size Calculation for the Cochran-Mantel-Haenszel Test</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/pegeler/samplesizeCMH/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Power and sample size calculation for the Cochran-Mantel-Haenszel test</h1>
      <small class="dont-index">Source: <a href="https://github.com/pegeler/samplesizeCMH/R/power.cmh.test.r"><code>R/power.cmh.test.r</code></a></small>
      <div class="d-none name"><code>power.cmh.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the post-hoc power or required number of subjects for the
Cochran-Mantel-Haenszel test for association in <em>J</em> stratified 2 x 2
tables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power.cmh.test</span><span class="op">(</span></span>
<span>  p1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  t <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">J</span>,</span>
<span>  correct <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p-">p1<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Vector of proportions of the <em>J</em> case groups.</p></dd>


<dt id="arg-p-">p2<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Vector of proportions of the <em>J</em> control groups.</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Vector of odds ratios relating to the <em>J</em> 2 x 2 tables.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Total number of subjects.</p></dd>


<dt id="arg-sig-level">sig.level<a class="anchor" aria-label="anchor" href="#arg-sig-level"></a></dt>
<dd><p>Significance level (Type I error probability).</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>Power of test (1 minus Type II error probability).</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>Two- or one-sided test. If one-sided, the direction of the
association must be defined (less than 1 or greater than 1). Can be
abbreviated.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>Proportion (weight) of case versus control in <em>J</em> stratum.</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>Proportion (weight) of total number of cases of <em>J</em> stratum.</p></dd>


<dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>Logical indicating whether to apply continuity correction.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"power.cmh"</code>: a list of the original arguments and
the calculated sample size or power. Also included are vectors of n's per
each group, an indicator or whether continuity correction was used, the
original function call, and <code>N.effective</code>.</p>
<p>The vectors of n's per each group, <code>n1</code> and <code>n2</code>, are the
fractional n's required to achieve a final total N specified by the
calculation while satisfying the constraints of <code>s</code> and <code>t</code>.
However, the effective N, given the requirement of cell counts populated by
whole numbers is provided by <code>N.effective</code>. By default, the print method
is set to <code>n.frac = FALSE</code>, which will round each cell n up to the
nearest whole number.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This sample size calculation is based on the derivations described in the
Woolson <em>et al.</em> (1986). It is designed for case-control studies where
one margin is fixed. The method is "based on the Cochran-Mantel-Haenszel
statistic expressed as a weighted difference in binomial proportions."</p>
<p>Continuity corrected sample size is described in Nam's 1992 paper. This uses
the weighted binomial sample size calculation described in Woolson <em>et
al.</em> (1986) but is enhanced for use with the continuity corrected Cochran's
test.</p>
<p>Power calculations are based on the writings of Wittes and Wallenstein
(1987). They are functionally equivalent to the derivations of the sample
size calculation described by Woolson and others and Nam, but have slightly
added precision.</p>
<p>Terminology and symbolic conventions are borrowed from Woolson <em>et al.</em>
(1986). The <code>p1</code> group is dubbed the <em>Case</em> group and <code>p2</code>
group is called the <em>Control</em> group.</p>
    </div>
    <div class="section level2">
    <h2 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h2>



<p>To calculate <strong>power</strong>, the <code>power</code> parameter must be set to
<code>NULL</code>. To calculate <strong>sample size</strong>, the <code>N</code> parameter must
be set to <code>NULL</code>.</p>
<p>The <code>J</code> number of groups will be inferred by the maximum length of
<code>p1</code>, <code>p2</code>, or <code>theta</code>.</p>
<p>Effect size must be specified using one of the following combinations of
arguments.</p><ul><li><p>Both case and control proportion vectors, ex.,</p><ul><li><p><code>p1</code> and <code>p2</code> with <code>theta = NULL</code>.</p></li>
</ul></li>
<li><p>One proportion vector and an effect size, ex.,</p><ul><li><p><code>p1</code> and <code>theta</code> with <code>p2 = NULL</code>, <strong>or</strong></p></li>
<li><p><code>p2</code> and <code>theta</code> with <code>p1 = NULL</code>.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gail, M. (1973). "The determination of sample sizes for trials involving
several 2 x 2 tables."
<em>Journal of Chronic Disease</em> <strong>26</strong>: 669-673.</p>
<p>Munoz, A. and B. Rosner. (1984). "Power and sample size for a collection of 2
x 2 tables." <em>Biometrics</em> <strong>40</strong>: 995-1004.</p>
<p>Nam, J. (1992). "Sample size determination for case-control studies and the
comparison of stratified and unstratified analyses."
<em>Biometrics</em> <strong>48</strong>: 389-395.</p>
<p>Wittes, J. and S. Wallenstein. (1987). "The power of the Mantel-Haenszel
test." <em>Journal of the American Statistical Association</em> <strong>82</strong>:
1104-1109.</p>
<p>Woolson, R. F., Bean, J. A., and P. B. Rojas. (1986).
"Sample size for case-control studies using Cochran's statistic."
<em>Biometrics</em> <strong>42</strong>: 927-932.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/stats/power.prop.test.html" class="external-link">power.prop.test</a>,
<a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a>,
<a href="https://andrisignorell.github.io/DescTools/reference/BreslowDayTest.html" class="external-link">BreslowDayTest</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul W. Egeler, M.S.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># From "Sample size determination for case-control studies and the comparison</span></span></span>
<span class="r-in"><span><span class="co"># of stratified and unstratified analyses", (Nam 1992). See references.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Uncorrected sample size estimate first introduced</span></span></span>
<span class="r-in"><span><span class="co"># by Woolson and others in 1986</span></span></span>
<span class="r-in"><span><span class="va">sample_size_uncorrected</span> <span class="op">&lt;-</span> <span class="fu">power.cmh.test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.70</span>,<span class="fl">0.65</span>,<span class="fl">0.60</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  power <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>  t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.40</span>,<span class="fl">0.35</span>,<span class="fl">0.15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alternative <span class="op">=</span> <span class="st">"greater"</span>,</span></span>
<span class="r-in"><span>  correct <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_size_uncorrected</span>, detail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power and sample size calculation for the Cochran Mantel Haenszel test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  N = 171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Effective N = 174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Power = 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Alternative = greater</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power.cmh.test(p2 = c(0.75, 0.7, 0.65, 0.6), theta = 3, power = 0.9, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = "greater", t = c(0.1, 0.4, 0.35, 0.15), correct = FALSE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We see that the N is 171, the same as calculated by Nam</span></span></span>
<span class="r-in"><span><span class="va">sample_size_uncorrected</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 170.7412</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Continuity corrected sample size estimate added by Nam</span></span></span>
<span class="r-in"><span><span class="va">sample_size_corrected</span> <span class="op">&lt;-</span> <span class="fu">power.cmh.test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.70</span>,<span class="fl">0.65</span>,<span class="fl">0.60</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  power <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>  t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.40</span>,<span class="fl">0.35</span>,<span class="fl">0.15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  alternative <span class="op">=</span> <span class="st">"greater"</span>,</span></span>
<span class="r-in"><span>  correct <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_size_corrected</span>, n.frac <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power and sample size calculation for the Cochran Mantel Haenszel test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  N = 191.538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Effective N = 196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Power = 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Alternative = greater</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of subjects per each group:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ______________________________________________</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group   |       1        2        3        4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ==============================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Case    |    9.58    38.31    33.52    14.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Control |    9.58    38.31    33.52    14.37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power.cmh.test(p2 = c(0.75, 0.7, 0.65, 0.6), theta = 3, power = 0.9, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alternative = "greater", t = c(0.1, 0.4, 0.35, 0.15), correct = TRUE)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We see that the N is indeed equal to that which is reported in the paper</span></span></span>
<span class="r-in"><span><span class="va">sample_size_corrected</span><span class="op">$</span><span class="va">N</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 191.538</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Egeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


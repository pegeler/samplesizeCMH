<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the Cochran-Mantel-Haenszel Test • samplesizeCMH</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the Cochran-Mantel-Haenszel Test">
<meta property="og:description" content="samplesizeCMH">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">samplesizeCMH</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/samplesizeCMH-introduction.html">Introduction to the Cochran-Mantel-Haenszel Test</a>
    </li>
    <li>
      <a href="../articles/samplesizeCMH-power.html">Power Calculation for the Cochran-Mantel-Haenszel Test</a>
    </li>
    <li>
      <a href="../articles/samplesizeCMH-samplesize.html">Sample Size Calculation for the Cochran-Mantel-Haenszel Test</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pegeler/samplesizeCMH/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the Cochran-Mantel-Haenszel
Test</h1>
                        <h4 data-toc-skip class="author">Paul W. Egeler,
M.S., GStat</h4>
            
            <h4 data-toc-skip class="date">2023-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pegeler/samplesizeCMH/blob/HEAD/vignettes/samplesizeCMH-introduction.Rmd" class="external-link"><code>vignettes/samplesizeCMH-introduction.Rmd</code></a></small>
      <div class="hidden name"><code>samplesizeCMH-introduction.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>Cochran-Mantel-Haenszel test</strong> (CMH) is an
inferential test for the association between two binary variables, while
controlling for a third confounding nominal variable <span class="citation">(Cochran 1954; Mantel and Haenszel 1959)</span>.
Essentially, the CMH test examines the <em>weighted</em> association of
a set of 2 <span class="math inline">\(\times\)</span> 2 tables. A
common odds ratio relating to the test statistic can also be generated
<span class="citation">(Mantel and Haenszel 1959)</span>. The CMH test
is a common technique in the field of biostatistics, where it is often
used for case-control studies.</p>
<p>This introduction briefly describes some of the terminology and
concepts surrounding stratified tables. Examples are given which show
some basic techniques for working with multidimensional tables in
<code>R</code>. Functionality of the <code>samplesizeCMH</code> package
is highlighted where it may augment the analysis.</p>
</div>
<div class="section level2">
<h2 id="partial-and-marginal-tables">Partial and Marginal Tables<a class="anchor" aria-label="anchor" href="#partial-and-marginal-tables"></a>
</h2>
<p>Consider a contingency table comparing <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> at some fixed level of <span class="math inline">\(Z\)</span>. The cross-section of the three-way
table examining only one level of <span class="math inline">\(Z\)</span>
is called a <em>partial table</em>. On the other hand, the combined
counts of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> across all levels of <span class="math inline">\(Z\)</span>, <em>id est</em> a simple two-way
contingency table ignoring <span class="math inline">\(Z\)</span>,
produce the <em>marginal table</em>. These concepts are described in
depth by <span class="citation">Agresti (2002, sec. 2.7.1)</span>.</p>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>We will use the <code class="sourceCode r">Titanic</code> dataset in
the <code class="sourceCode r">datasets</code> package to illustrate.
This dataset is a four-dimensional table which includes the
<em>Class</em> (1<sup>st</sup>, 2<sup>nd</sup>, 3<sup>rd</sup>, Crew),
<em>Sex</em> (Male, Female), <em>Age</em> (Child, Adult), and
<em>Survival</em> (No, Yes) of the passengers of the 1912 maritime
disaster. Use <code class="sourceCode r"><span class="fu">help</span>(<span class="st">"Titanic"</span>, <span class="st">"datasets"</span>)</code>
to find more information.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Titanic</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  'table' num [1:4, 1:2, 1:2, 1:2] 0 0 35 0 0 0 17 0 118 154 ...</span></span>
<span><span class="co">##  - attr(*, "dimnames")=List of 4</span></span>
<span><span class="co">##   ..$ Class   : chr [1:4] "1st" "2nd" "3rd" "Crew"</span></span>
<span><span class="co">##   ..$ Sex     : chr [1:2] "Male" "Female"</span></span>
<span><span class="co">##   ..$ Age     : chr [1:2] "Child" "Adult"</span></span>
<span><span class="co">##   ..$ Survived: chr [1:2] "No" "Yes"</span></span></code></pre>
<p>For this illustration, we will remove the <em>age</em> dimension,
transforming the four-dimensional table into a three-dimensional table.
Let <span class="math inline">\(X\)</span> = sex, <span class="math inline">\(Y\)</span> = survival, and <span class="math inline">\(Z\)</span> = class. This dimensionality reduction
is accomplished using the <code class="sourceCode r"><span class="fu">margin.table</span>()</code>
function in the <code>base</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partial_tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/marginSums.html" class="external-link">margin.table</a></span><span class="op">(</span><span class="va">Titanic</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">partial_tables</span></span></code></pre></div>
<pre><code><span><span class="co">## , , Class = 1st</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex       No Yes</span></span>
<span><span class="co">##   Male   118  62</span></span>
<span><span class="co">##   Female   4 141</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , Class = 2nd</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex       No Yes</span></span>
<span><span class="co">##   Male   154  25</span></span>
<span><span class="co">##   Female  13  93</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , Class = 3rd</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex       No Yes</span></span>
<span><span class="co">##   Male   422  88</span></span>
<span><span class="co">##   Female 106  90</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , Class = Crew</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex       No Yes</span></span>
<span><span class="co">##   Male   670 192</span></span>
<span><span class="co">##   Female   3  20</span></span></code></pre>
<p>Each of the tables above is a partial table: <em>survival by sex at a
fixed level of class</em>. The tables can be flattened for easier
viewing using the <code class="sourceCode r"><span class="fu">ftable</span>()</code> function in
the <code class="sourceCode r">stats</code> package (not shown).</p>
<p>The code below shows the marginal table of survival by sex, ignoring
class. Again the dimensionality is reduced using the <code class="sourceCode r"><span class="fu">margin.table</span>()</code>
function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">marginal_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/marginSums.html" class="external-link">margin.table</a></span><span class="op">(</span><span class="va">Titanic</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">marginal_table</span></span></code></pre></div>
<pre><code><span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex        No  Yes</span></span>
<span><span class="co">##   Male   1364  367</span></span>
<span><span class="co">##   Female  126  344</span></span></code></pre>
<p>As an aside, we may get the table, row, or column proportions using
the <code class="sourceCode r"><span class="fu">prop.table</span>()</code>
function. Because the <code class="sourceCode r">Titanic</code> dataset
is a multidimensional table, it must first be transformed into a
two-dimensional table using <code class="sourceCode r"><span class="fu">margin.table</span>()</code> (as
was performed above). Failure to do so will produce unexpected
results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table proportions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">marginal_table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex              No        Yes</span></span>
<span><span class="co">##   Male   0.61971831 0.16674239</span></span>
<span><span class="co">##   Female 0.05724671 0.15629259</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Row proportions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">marginal_table</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex             No       Yes</span></span>
<span><span class="co">##   Male   0.7879838 0.2120162</span></span>
<span><span class="co">##   Female 0.2680851 0.7319149</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Column proportions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">marginal_table</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         Survived</span></span>
<span><span class="co">## Sex              No        Yes</span></span>
<span><span class="co">##   Male   0.91543624 0.51617440</span></span>
<span><span class="co">##   Female 0.08456376 0.48382560</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="conditional-marginal-and-common-odds-ratios">Conditional, Marginal, and Common Odds Ratios<a class="anchor" aria-label="anchor" href="#conditional-marginal-and-common-odds-ratios"></a>
</h2>
<p>In comparing variables <span class="math inline">\(X\)</span> and
<span class="math inline">\(Y\)</span> at a fixed <span class="math inline">\(j\)</span> level of <span class="math inline">\(Z\)</span>, we may use a <em>conditional odds
ratio</em>, described by <span class="citation">Agresti (2002, sec.
2.7.4)</span>, to represent the point estimate of association between
the to variables. We will denote it as <span class="math inline">\(\theta_{XY(j)}\)</span>. The <em>marginal odds
ratio</em> would then refer to the odds ratio of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> generated by the marginal table. It
follows that the marginal odds ratio would be denoted by <span class="math inline">\(\theta_{XY}\)</span>.</p>
<p>An odds ratio estimate (<span class="math inline">\(\hat\theta\)</span>) can be calculated from a
table or matrix using the <code class="sourceCode r">samplesizeCMH</code> package using the <code class="sourceCode r"><span class="fu">odds.ratio</span>()</code>
function. The <code class="sourceCode r"><span class="fu">odds.ratio</span>()</code>
function can take either a table of frequencies, probabilities, or
percents, as the results are algebraicly equivalent.</p>
<div class="section level3">
<h3 id="demonstration-of-algebraic-equivalence-of-using-frequencies-or-proportions-in-odds-ratio-calculation">Demonstration of Algebraic Equivalence of using Frequencies or
Proportions in Odds Ratio Calculation<a class="anchor" aria-label="anchor" href="#demonstration-of-algebraic-equivalence-of-using-frequencies-or-proportions-in-odds-ratio-calculation"></a>
</h3>
<p>Using proportions, we see how the ratio of the row odds <span class="math inline">\(o_1\)</span> and <span class="math inline">\(o_2\)</span> are estimated.</p>
<p><span class="math display">\[
\hat{\theta}=
\frac{\hat{o}_1}{\hat{o}_2} =
\frac{\hat{\pi}_{11} / \hat{\pi}_{12}}{\hat{\pi}_{21} / \hat{\pi}_{22}}
=
\frac{\hat{\pi}_{11}\hat{\pi}_{22}}{\hat{\pi}_{12}\hat{\pi}_{21}}.
\]</span></p>
<p>And since row odds estimates are related row proportions, which are
in turn related to to cell counts through the following,</p>
<p><span class="math display">\[
\hat{o} =
\frac{\hat{\pi}_1}{1 - \hat{\pi}_1} =
\frac{\hat{\pi}_1}{\hat{\pi}_2} =
\frac{n_1 / n_+}{n_2 / n_+} =
\frac{n_1}{n_2},
\]</span></p>
<p>the odds estimate, defined as <span class="math inline">\(\frac{\hat{\pi}_1}{\hat{\pi}_2}\)</span>, is
equivalent to <span class="math inline">\(\frac{n_1}{n_2}\)</span>.
Therefore,</p>
<p><span class="math display">\[
\hat{\theta}=
\frac{\hat{\pi}_{11}\hat{\pi}_{22}}{\hat{\pi}_{12}\hat{\pi}_{21}} =
\frac{n_{11}n_{22}}{n_{12}n_{21}}.
\]</span></p>
</div>
<div class="section level3">
<h3 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>Let’s first look at the marginal odds ratio of survival by sex using
the Titanic data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pegeler/samplesizeCMH" class="external-link">samplesizeCMH</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/odds.ratio.html">odds.ratio</a></span><span class="op">(</span><span class="va">marginal_table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 10.14697</span></span></code></pre>
<p>The conditional odds ratios can be calculated using the partial
tables.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">partial_tables</span>, <span class="fl">3</span>, <span class="va">odds.ratio</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       1st       2nd       3rd      Crew </span></span>
<span><span class="co">## 67.088710 44.067692  4.071612 23.263889</span></span></code></pre>
<p>Obviously this is more informative than a simple marginal odds ratio.
Based on what we see above, survival by sex appears to vary widely by
class, where women in 1<sup>st</sup> class survive at a much higher rate
than men, whereas 3<sup>rd</sup> class women had only slightly better
chance of survival than their male counterparts.</p>
<p>We can produce a <em>common (weighted) odds ratio</em> using <code class="sourceCode r"><span class="fu">mantelhaen.test</span>()</code>
from the <code class="sourceCode r">stats</code> package. Note that it
differs slightly from the marginal odds ratio above since it takes into
account the differential sizes of each partial table.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/mantelhaen.test.html" class="external-link">mantelhaen.test</a></span><span class="op">(</span><span class="va">partial_tables</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Mantel-Haenszel chi-squared test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  partial_tables</span></span>
<span><span class="co">## Mantel-Haenszel X-squared = 360.33, df = 1, p-value &lt; 2.2e-16</span></span>
<span><span class="co">## alternative hypothesis: true common odds ratio is not equal to 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##   8.232629 14.185153</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## common odds ratio </span></span>
<span><span class="co">##          10.80653</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="conditional-and-marginal-associationindependence">Conditional and Marginal Association/Independence<a class="anchor" aria-label="anchor" href="#conditional-and-marginal-associationindependence"></a>
</h2>
<p>The term <em>conditional association</em> refers to the association
of the <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables conditional on the level of
<span class="math inline">\(Z\)</span>. Likewise, the <em>marginal
association</em> refers to the overall association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> while ignoring <span class="math inline">\(Z\)</span>.</p>
<p>The finding of conditional association does not imply marginal
association, nor vice-versa. The use of the CMH test to control for the
stratifying variable in analysis serves to avoid the well-documented
phenomenon of the Simpson’s Paradox in which statistical significance
may be found when considering the association between two variables, but
where no such significance may be found after considering the
stratification. Likewise, the reverse situation may arise where no
association may be found between the binary variables, but may be
observed when the third variable is introduced.</p>
<p>Refer to <span class="citation">Agresti (2002, sec. 2.7.3)</span> for
more information on the content of this section.</p>
</div>
<div class="section level2">
<h2 id="homogeneous-associationindependence">Homogeneous Association/Independence<a class="anchor" aria-label="anchor" href="#homogeneous-associationindependence"></a>
</h2>
<p><em>Homogeneous association</em> is when all the odds ratios between
binary variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are equal for all <span class="math inline">\(j\)</span> levels of variable <span class="math inline">\(Z\)</span>, such that <span class="math display">\[\theta_{XY(1)}=\theta_{XY(2)}=...=\theta_{XY(j)}.\]</span>
<span class="citation">(Agresti 2002, sec. 2.7.6)</span></p>
<p>The Breslow-Day test can be used to check the null hypothesis that
all odds ratios are equal. The Cochran-Mantel-Haenszel test can be
thought of as a special case of the Breslow-Day test wherein the common
odds ratio is assumed to be 1 (however, the calculations are not
equivalent). Using the <code>Titanic</code> data, we can perform the
Breslow-Day test using <code class="sourceCode r"><span class="fu">BreslowDayTest</span>()</code>
from the <code class="sourceCode r">DescTools</code> package.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/" class="external-link">DescTools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/BreslowDayTest.html" class="external-link">BreslowDayTest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">partial_tables</span>, OR <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Breslow-Day test on Homogeneity of Odds Ratios</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  partial_tables</span></span>
<span><span class="co">## X-squared = 397.54, df = 3, p-value &lt; 2.2e-16</span></span></code></pre>
<p>Note the near agreement with the output from <code class="sourceCode r"><span class="fu">mantelhaen.test</span>()</code>
from the section above.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Agresti" class="csl-entry">
Agresti, A. 2002. <em><span class="nocase">An Introduction to
Categorical Data Analysis</span></em>. 2nd ed. Wiley Series in
Probability and Statistics. Wiley-Interscience.
</div>
<div id="ref-Cochran1954" class="csl-entry">
Cochran, William G. 1954. <span>“Some Methods for Strengthening the
Common Chi-Squared Tests.”</span> <em>Biometrics</em> 10 (4): 417–51. <a href="https://www.jstor.org/stable/3001616" class="external-link">https://www.jstor.org/stable/3001616</a>.
</div>
<div id="ref-Mantel1959" class="csl-entry">
Mantel, N., and W. Haenszel. 1959. <span>“Statistical Aspects of the
Analysis of Data from Retrospective Studies of Disease.”</span>
<em>Journal of the National Cancer Institute</em> 22 (4): 719–48. <a href="https://pubmed.ncbi.nlm.nih.gov/13655060" class="external-link">https://pubmed.ncbi.nlm.nih.gov/13655060</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul Egeler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
